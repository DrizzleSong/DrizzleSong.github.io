<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- 修正后的 meta refresh：注意分号 -->
  <meta http-equiv="refresh" content="2; url=html/home.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cover Demo</title>
  <style>
    /* Reset */
    * { box-sizing: border-box; margin: 0; padding: 0; }

    html, body { height: 100%; }

    /* 全屏封面 */
    .cover {
      position: relative;
      width: 100%;
      min-height: 100vh;              /* 覆盖整个视口 */
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;               /* 后备色 */
    }

    /* 背景图层（在 cover::before） */
    .cover::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: url('https://img2.imgtp.com/2024/03/17/iOhR2vZ5.jpg');
      background-size: cover;
      background-position: center;
      transform-origin: center;
      z-index: 0;
      will-change: transform;
      filter: saturate(1.05) contrast(1.02);
    }

    /* 文字容器，放在 cover 之上 */
    .content {
      position: relative;
      z-index: 2;
      display: inline-block;         /* 宽度动画对 inline-block 有效 */
      overflow: hidden;
      white-space: nowrap;
      /* 使用 clamp 让字体在不同屏幕下自适应 */
      font-weight: 900;
      font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-size: clamp(3rem, 12vw, 9rem);
      letter-spacing: 0.08em;
      line-height: 1;
      text-transform: uppercase;
      /* 将背景图直接放在文字上并裁剪到文字 */
      background-image: url('https://img2.imgtp.com/2024/03/17/iOhR2vZ5.jpg');
      background-size: cover;
      background-position: center;
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      color: transparent;
      /* 为 reveal 动画准备：初始宽度为 0 */
      width: 0;
    }

    /* reveal 动画：从 0 到 100% */
    @keyframes reveal {
      from { width: 0; }
      to   { width: 100%; }
    }

    /* 当添加 .is-revealed 类时触发动画 */
    .content.is-revealed {
      animation: reveal 1.4s steps(20, end) forwards;
    }

    /* 可选：一个副标题示例 */
    .subtitle {
      position: absolute;
      bottom: 4vh;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(255,255,255,0.85);
      background: rgba(0,0,0,0.35);
      padding: 0.6rem 1rem;
      border-radius: 8px;
      z-index: 2;
      font-size: clamp(0.9rem, 2.5vw, 1.1rem);
      backdrop-filter: blur(4px);
    }

    /* 小屏适配，避免 letter-spacing 太大 */
    @media (max-width: 480px) {
      .content { letter-spacing: 0.04em; }
    }
  </style>
</head>
<body>
  <div class="cover">
    <div class="content" id="heroText">WELCOME</div>
    <div class="subtitle">Auto-redirecting in 2s…</div>
  </div>

  <script>
    // 性能友好的滚动视差：将 ::before 的 transform 用 requestAnimationFrame 更新
    (function() {
      const cover = document.querySelector('.cover');
      const bg = document.querySelector('.cover::before'); // 不能直接选伪元素
      // 所以我们修改 cover 的 style 来影响伪元素：利用 CSS 变量
      // 修改 CSS，将伪元素的 transform 来源于 --bg-translate
      document.styleSheets[0].insertRule(`
        .cover::before { transform: translateY(var(--bg-translate, 0px)); }
      `, document.styleSheets[0].cssRules.length);

      let latestY = 0;
      let ticking = false;

      function onScroll() {
        latestY = window.scrollY;
        if (!ticking) {
          requestAnimationFrame(() => {
            // 我们以较小幅度移动背景，创造视差效果
            const move = latestY * 0.3; // 倍率可调
            document.querySelector('.cover').style.setProperty('--bg-translate', move + 'px');
            ticking = false;
          });
          ticking = true;
        }
      }

      window.addEventListener('scroll', onScroll, { passive: true });

      // 启动 reveal 动画（也可以基于时间或交互触发）
      const hero = document.getElementById('heroText');
      // 延迟小量以便 CSS 渲染就绪
      setTimeout(() => hero.classList.add('is-revealed'), 200);
    })();
  </script>
</body>
</html>
