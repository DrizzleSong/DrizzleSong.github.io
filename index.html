<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- 修正后的 meta refresh：注意分号 -->
  <meta http-equiv="refresh" content="2; url=html/home.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cover Demo</title>
  <link rel="stylesheet" href="css/index.css">
  
</head>
<body>
  <div class="cover">
    <div class="content" id="heroText">WELCOME</div>
    <div class="subtitle">Auto-redirecting in 2s…</div>
  </div>

  <script>
    // 性能友好的滚动视差：将 ::before 的 transform 用 requestAnimationFrame 更新
    (function() {
      const cover = document.querySelector('.cover');
      const bg = document.querySelector('.cover::before'); // 不能直接选伪元素
      // 所以我们修改 cover 的 style 来影响伪元素：利用 CSS 变量
      // 修改 CSS，将伪元素的 transform 来源于 --bg-translate
      document.styleSheets[0].insertRule(`
        .cover::before { transform: translateY(var(--bg-translate, 0px)); }
      `, document.styleSheets[0].cssRules.length);

      let latestY = 0;
      let ticking = false;

      function onScroll() {
        latestY = window.scrollY;
        if (!ticking) {
          requestAnimationFrame(() => {
            // 我们以较小幅度移动背景，创造视差效果
            const move = latestY * 0.3; // 倍率可调
            document.querySelector('.cover').style.setProperty('--bg-translate', move + 'px');
            ticking = false;
          });
          ticking = true;
        }
      }

      window.addEventListener('scroll', onScroll, { passive: true });

      // 启动 reveal 动画（也可以基于时间或交互触发）
      const hero = document.getElementById('heroText');
      // 延迟小量以便 CSS 渲染就绪
      setTimeout(() => hero.classList.add('is-revealed'), 200);
    })();
  </script>
</body>
</html>
